---
// é™æ€å›¾ç‰‡
// Svg ç»„ä»¶
import Svg from "@/components/Svg/Svg.astro";
// æ—¶é—´å¤„ç†
import { fmtTime } from "@/utils/index";
// è·å–ç”¨æˆ·é…ç½®æ•°æ®
import SITE_CONFIG from "@/config";
const { Avatar, Author, Motto, WebSites, GoogleAds, AsideShow } = SITE_CONFIG;
// è·å–æ–‡ç« æ•°æ®
import { getCategories, getTags, getRecommendArticles, getCountInfo } from "@/utils/getPostInfo";
// è·å–æ•°æ®ç»Ÿè®¡
// åˆ†ç±»åˆ—è¡¨
const categories = getCategories();
// çƒ­é—¨æ ‡ç­¾
const tags = getTags().slice(0, 16);
// è·å–ç½‘ç«™ç»Ÿè®¡æ•°æ®
const CountInfo = getCountInfo();
// æœ€æ–°æ–‡ç« 
const recommendArticles = getRecommendArticles();
// Google å¹¿å‘Šç»„ä»¶
import GoogleAd from "@/components/GoogleAd/GoogleAd.astro";
// ä¾§è¾¹æ æ ·å¼
import "./Aside.less";
---

<aside class="vh-aside">
	<!-- å¤´åƒå— -->
	{
		AsideShow.WebSitesShow && (
			<section class="vh-aside-item user">
				<img class="vh-aside-avatar" src="/assets/images/lazy-loading.webp" data-vh-lz-src={Avatar} alt={Author} />
				<span class="vh-aside-auther">{Author}</span>
				<p class="vh-aside-motto">{Motto}</p>
				<section class="vh-aside-links">
					{WebSites.map(item => (
						<a class="vh-aside-links-item" href={item.link} title={item.text} target="_blank" rel="noopener nofollow">
							<Svg src={item.icon} />
						</a>
					))}
				</section>
				<section class="vh-aside-info">
					<div class="art-item count">
						<span>{CountInfo.ArticleCount}</span>
						<p>æ–‡ç« æ•°</p>
					</div>
					<div class="cat-item count">
						<span>{CountInfo.CategoryCount}</span>
						<p>åˆ†ç±»æ•°</p>
					</div>
					<div class="tag-item count">
						<span>{CountInfo.TagCount}</span>
						<p>æ ‡ç­¾æ•°</p>
					</div>
				</section>
				<canvas class="vh-aside-canvas" width="888" height="1888" />
			</section>
		)
	}

	<!-- å…¬å‘Šå— -->
	{
		SITE_CONFIG.Tips && (
			<section class="vh-aside-item tips">
				<span>
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none" />
						<path d="M3 9.662c2 2.338 2 4.338 0 6.338c3 .5 4.5 1 5 4c2 -3 6 -4 9 0c0 -3 1 -4 4 -4.004q -3 -2.995 0 -5.996c-3 0 -5 -2 -5 -5c-2 4 -5 3 -7.5 -1c-.5 3 -2.5 5 -5.5 5.662" />
					</svg>
					å…¬å‘Š
				</span>
				<div class="tips-content">
					<Fragment set:html={SITE_CONFIG.Tips} />
				</div>
			</section>
		)
	}

	<!-- åˆ†ç±»å— -->
	{
		AsideShow.CategoriesShow && (
			<section class="vh-aside-item cat">
				<h3>åˆ†ç±»</h3>
				<div class="vh-aside-cat">
					{categories
						.sort((a: any, b: any) => b.count - a.count)
						.map(i => (
							<a href={`/categories/${i.title}`}>
								<span>{i.title}</span>
								<i>{i.count}</i>
							</a>
						))}
				</div>
			</section>
		)
	}

	<!-- æ ‡ç­¾å— -->
	{
		AsideShow.TagsShow && (
			<section class="vh-aside-item tags">
				<h3>çƒ­é—¨æ ‡ç­¾</h3>
				<div class="vh-aside-tags">
					{tags.map(i => (
						<a href={`/tag/${i[0]}`}>
							<span>{i[0]}</span>
							<em>{i[1]}</em>
						</a>
					))}
				</div>
			</section>
		)
	}

	<!-- æµé‡å¡ -->
	{
		(
			<section class="vh-aside-item adcard">
				<h3>ğŸ…ç•ªèŒ„ä¸»ç†äºº</h3>
				<a class="vh-aside-adcard" href="https://www.fqzlr.top/" target="_blank" rel="noopener noreferrer">
					<img src="https://tu.fqzlr.top/file/fqzlr/2026/02/21/1771677892117_20260221204426671.png" alt="ç•ªèŒ„ä¸»ç†äºº">
				</a>
			</section>
		)
	}

	<section class="sticky-aside">
		<!-- æœ€æ–°æ–‡ç« å— -->
		{
			recommendArticles.length && AsideShow.recommendArticleShow && (
				<section class="vh-aside-item articles">
					<h3>æ¨èæ–‡ç« </h3>
					<div class="vh-aside-articles">
						{recommendArticles.map((i, idx) => (
							<a href={`/article/${i.id}`}>
								<span>
									{idx < 3 ? <i>{idx + 1}</i> : <em>{idx + 1}.</em>}
									<cite class="vh-ellipsis">{i.title}</cite>
								</span>
								<time>{fmtTime(i.date, "YYYY-MM-DD A")}</time>
							</a>
						))}
					</div>
				</section>
			)
		}

		<!-- è°·æ­Œå¹¿å‘Šå— -->
		{
			GoogleAds.ad_Client && GoogleAds.asideAD_Slot && (
				<section class="vh-aside-item ad">
					<h3>å¹¿è€Œå‘Šä¹‹</h3>
					<GoogleAd className="vh-aside-ad" slotID={GoogleAds.asideAD_Slot} />
				</section>
			)
		}
	</section>
</aside>
